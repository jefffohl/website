# CVE-2025-55182 Incident Response Checklist

**Incident Date:** December 5-6, 2025  
**Attack Vector:** CVE-2025-55182 (React Server Components RCE)  
**Attack Type:** Cryptocurrency mining (XMRig/Monero)

---

## âœ… Completed Items

### Malware Removal

-   [x] Took forensic snapshot on Digital Ocean
-   [x] Killed XMRig cryptocurrency miner
-   [x] Killed watcher respawner daemon
-   [x] Killed fake dockerd processes
-   [x] Killed bash respawner script (PID 1340496)
-   [x] Killed old vulnerable Next.js process (v15.3.1)
-   [x] Removed malware from `/tmp/` (fghgf, watcher, config.json, dockerd, etc.)
-   [x] Removed malware from `~/4thepool/`
-   [x] Removed malware from `~/.rsyslo/`
-   [x] Removed malware from `~/website/frontend/`
-   [x] Cleaned `.profile` (removed xmrig persistence line)

### Patching

-   [x] Updated React: 19.0.0 â†’ 19.0.1
-   [x] Updated Next.js: 15.3.1 â†’ 15.3.6
-   [x] Rebuilt frontend application
-   [x] Restarted frontend via PM2

### Verification

-   [x] Verified system CPU back to normal (~0.29 load)
-   [x] Verified no malicious processes running
-   [x] Verified no SSH backdoors (authorized_keys)
-   [x] Verified no password/sudo interception
-   [x] Verified no malicious aliases or functions
-   [x] Verified PostgreSQL users are legitimate
-   [x] Verified MySQL users are legitimate
-   [x] Verified no PHP backdoors installed
-   [x] Verified phpMyAdmin is not web-accessible

---

## ðŸ”´ High Priority - Do Immediately

### Rotate Exposed Credentials

#### SSL Certificate (Private Key Exposed)

-   [x] Fix permissions on SSL directory:
    ```bash
    sudo chmod 600 /etc/apache2/ssl/*.pem
    sudo chmod 700 /etc/apache2/ssl/
    ```
-   [ ] Log into Cloudflare Dashboard â†’ SSL/TLS â†’ Origin Server
-   [ ] Revoke the existing Origin CA certificate
-   [ ] Generate new Origin CA certificate
-   [ ] Download new certificate and private key
-   [ ] Update `/etc/apache2/ssl/fohl_com_combined.pem` with new cert+key
-   [ ] Restart HAProxy: `sudo systemctl restart haproxy`
-   [ ] Verify site still works

#### Database Credentials (Were Readable)

-   [x] Generate new PostgreSQL password for `strapi_user`:

    ```bash
    # Generate secure password
    openssl rand -base64 24

    # Update in PostgreSQL
    sudo -u postgres psql -c "ALTER USER strapi_user WITH PASSWORD 'NEW_PASSWORD_HERE';"
    ```

-   [x] Update `~/website/backend/.env` with new `DATABASE_PASSWORD`
-   [x] Restart Strapi backend: `pm2 restart strapi-backend`

#### JWT Secrets (Were Readable)

-   [x] Generate new secrets:
    ```bash
    openssl rand -base64 32  # For ADMIN_JWT_SECRET
    openssl rand -base64 32  # For JWT_SECRET
    ```
-   [x] Update `~/website/backend/.env` with new secrets:
    -   `ADMIN_JWT_SECRET`
    -   `JWT_SECRET`
-   [x] Restart Strapi backend: `pm2 restart strapi-backend`
-   [x] **Note:** Changing JWT secrets will invalidate all existing sessions/tokens

---

## ðŸŸ¡ Medium Priority - Do Soon

### Local Development Environment

-   [x] Update frontend dependencies locally:
    ```bash
    cd /Users/jefffohl/dev/website/frontend
    npm install react@19.0.1 react-dom@19.0.1 next@15.3.6
    ```
-   [x] Commit the changes:
    ```bash
    git add package.json package-lock.json
    git commit -m "Security: Patch CVE-2025-55182 (React RCE vulnerability)"
    git push
    ```

### Password Changes (Precautionary)

-   [x] Change `webadmin` user password: `passwd`
-   [x] Update any password managers with new credentials

### Server Hardening

-   [ ] Install fail2ban for SSH brute-force protection:
    ```bash
    sudo apt install fail2ban
    sudo systemctl enable fail2ban
    sudo systemctl start fail2ban
    ```
-   [ ] Consider enabling SSH key-only authentication (disable password login)

---

## ðŸŸ¢ Low Priority - When Convenient

### Cleanup

-   [ ] Delete forensic backup of compromised `.profile`:
    ```bash
    rm ~/.profile.compromised
    ```
-   [ ] Optional: Remove orphaned phpMyAdmin files:
    ```bash
    rm -rf ~/www.fohl.com/html/phpmyadmin
    rm -rf ~/www.fohl.com/html/phpliteadmin
    ```

### Monitoring

-   [ ] Monitor server for 24-48 hours for any recurrence
-   [ ] Run periodic health check:
    ```bash
    ps aux | grep -E "(xmrig|miner|fghgf|docker-daemon)" | grep -v grep || echo "âœ… Clean"
    ```
-   [ ] Check Digital Ocean CPU graph has normalized
-   [ ] Keep forensic snapshot for 2-4 weeks, then delete

---

## ðŸ“‹ Quick Reference Commands

### Health Check

```bash
# Check for malware processes
ps aux | grep -E "(xmrig|miner|fghgf|docker-daemon|watcher)" | grep -v grep

# Check /tmp for suspicious files
find /tmp -user webadmin -ls 2>/dev/null

# Check CPU/load
top -b -n 1 | head -10

# Check PM2 apps are running
pm2 list
```

### Verify Patched Versions

```bash
cd ~/website/frontend && npm ls react next
# Should show: react@19.0.1, next@15.3.6
```

---

## ðŸ“š References

-   [CVE-2025-55182 Details](https://www.cve.org/CVERecord?id=CVE-2025-55182)
-   [NetSPI Advisory](https://www.netspi.com/newsroom/press-release/critical-vulnerability-cve-2025-55182/)
-   [CVE-2025-55182 Scanner](https://cve-2025-55182.com/)

---

_Last updated: December 6, 2025_
